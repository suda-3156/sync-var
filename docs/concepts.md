# Concepts

## sync-var とは

言語やディレクトリごとに存在する設定ファイルや、異なるファイル間で統一しておきたい変数を自動で同期するツール

## 要件

- コメント行で次の行（厳密に次の行のみ）についての指示を行う

### コマンド

- `init`: config ファイルのサンプルを作成する
- `validate`: config ファイルを元にファイルを読み取り、config ファイルとターゲットファイルの検証を行う
- `sync`: 変数を同期する
  - デフォルト動作: 上書き (overwrite)
  - `--backup` オプション: バックアップを作成
  - `--output-dir` オプション: 出力先ディレクトリを指定
  - `--dry-run` オプション: 実際には変更せず、差分のみ表示

### config ファイル形式

- ファイルパスを列挙する
  - 将来的に階層構造による指定を許容する
  - ワイルドカードにも対応予定
- masterfiles:
  - `default`: path/to/default/master/file（必須）
  - その他、環境名とそのマスターファイルを列挙する（ここで環境を登録する）

### 処理

基本的に置換を行う。

- インデントは別途保持する（タブ・スペース・数が異なる場合があるため）
- テンプレート形式: `asdf {{ env.VAR_NAME }}`
  - `{{ VAR_NAME }}` のように変数名のみの場合は `default` 環境を参照する

## 詳細

### ルール

- 環境は config で指定されたもの + `default` のみ許容する
  - `default` は環境名として使用できない（予約語）
- `環境.VAR_NAME` は一意でなければならない（`環境.VAR_NAME` をキーとして同期を行う）
- 環境名:
  - 英数字、`-`、`_` を使用可能（大文字小文字を区別しない）
- 変数名:
  - 英数字、`-`、`_` を使用可能（大文字小文字を区別しない）
- value:
  - 基本的に自由（Python パッケージでロードするため制限なし）
- タグ形式:
  - `[]` で囲む。英数字、`-`、`_` を使用可能（大文字小文字を区別しない）
